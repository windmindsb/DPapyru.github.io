<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown编辑器 - 泰拉瑞亚Mod制作教程</title>
    
    <!-- SEO优化标签 -->
    <meta name="description" content="泰拉瑞亚Mod制作教程网站的Markdown编辑器，支持实时预览和语法高亮">
    <meta name="keywords" content="Markdown,编辑器,实时预览,语法高亮,tModLoader">
    <meta name="author" content="泰拉瑞亚Mod社区">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph标签 -->
    <meta property="og:title" content="Markdown编辑器 - 泰拉瑞亚Mod制作教程">
    <meta property="og:description" content="支持实时预览和语法高亮的Markdown编辑器">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://dpapyru.github.io/docs/editor.html">
    <meta property="og:image" content="https://dpapyru.github.io/assets/imgs/Green_tModLoader.png">
    <meta property="og:site_name" content="泰拉瑞亚Mod制作教程">
    <meta property="og:locale" content="zh_CN">
    
    <!-- 样式表 -->
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/prism.min.css">
    <link rel="stylesheet" href="../assets/css/vs2022-theme.css">
    <link rel="stylesheet" href="../assets/css/editor.css">
    <link rel="icon" type="image/png" href="../assets/imgs/Green_tModLoader.png">
    
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    
    <!-- 主题切换早期加载脚本 -->
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
</head>

<body>
    <!-- 网站头部导航区域 -->
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <!-- 网站logo和标题 -->
                <div class="logo">
                    <a href="../index.html">
                        <img src="../assets/imgs/Green_tModLoader.png" alt="泰拉瑞亚Mod制作教程" class="logo-image">
                        <h1 class="site-title">警告！测试内容！</h1>
                    </a>
                </div>
                <!-- 主导航菜单 -->
                <nav class="main-nav">
                    <ul class="nav-list">
                        <li class="nav-item"><a href="../index.html" class="nav-link">首页</a></li>
                        <li class="nav-item"><a href="index.html" class="nav-link">文档</a></li>
                        <!-- <li class="nav-item"><a href="editor.html" class="nav-link active">编辑器</a></li> -->
                        <li class="nav-item"><a href="https://github.com/DPapyru/DPapyru.github.io" class="nav-link" target="_blank">GitHub</a></li>
                    </ul>
                </nav>
                <!-- 移动端菜单切换按钮 -->
                <button class="mobile-menu-toggle" aria-label="切换菜单">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- 编辑器主体区域 -->
    <main class="editor-main">
        <!-- 编辑器工具栏 -->
        <div class="editor-toolbar">
            <div class="toolbar-group">
                <button class="toolbar-btn" id="btn-bold" title="粗体 (Ctrl+B)">
                    <i class="icon-bold"></i>
                </button>
                <button class="toolbar-btn" id="btn-italic" title="斜体 (Ctrl+I)">
                    <i class="icon-italic"></i>
                </button>
                <button class="toolbar-btn" id="btn-heading" title="标题">
                    <i class="icon-heading"></i>
                </button>
                <button class="toolbar-btn" id="btn-link" title="链接 (Ctrl+K)">
                    <i class="icon-link"></i>
                </button>
                <button class="toolbar-btn" id="btn-image" title="图片">
                    <i class="icon-image"></i>
                </button>
                <button class="toolbar-btn" id="btn-code" title="代码">
                    <i class="icon-code"></i>
                </button>
                <button class="toolbar-btn" id="btn-quote" title="引用">
                    <i class="icon-quote"></i>
                </button>
                <button class="toolbar-btn" id="btn-list-ul" title="无序列表">
                    <i class="icon-list-ul"></i>
                </button>
                <button class="toolbar-btn" id="btn-list-ol" title="有序列表">
                    <i class="icon-list-ol"></i>
                </button>
                <button class="toolbar-btn" id="btn-table" title="表格">
                    <i class="icon-table"></i>
                </button>
                <button class="toolbar-btn" id="btn-hr" title="分割线">
                    <i class="icon-hr"></i>
                </button>
            </div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" id="btn-internal-link" title="内部文档链接">
                    <i class="icon-internal-link"></i>
                </button>
                <button class="toolbar-btn" id="btn-csharp-code" title="C#代码片段">
                    <i class="icon-csharp"></i>
                </button>
                <button class="toolbar-btn" id="btn-color-text" title="彩色文本">
                    <i class="icon-color"></i>
                </button>
                <button class="toolbar-btn" id="btn-tmodloader-ref" title="tModLoader引用">
                    <i class="icon-api"></i>
                </button>
            </div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" id="btn-undo" title="撤销 (Ctrl+Z)">
                    <i class="icon-undo"></i>
                </button>
                <button class="toolbar-btn" id="btn-redo" title="重做 (Ctrl+Y)">
                    <i class="icon-redo"></i>
                </button>
            </div>
            
            <div class="toolbar-group">
                <button class="toolbar-btn" id="btn-preview" title="切换预览">
                    <i class="icon-preview"></i>
                </button>
                <button class="toolbar-btn" id="btn-fullscreen" title="全屏">
                    <i class="icon-fullscreen"></i>
                </button>
                <button class="toolbar-btn" id="btn-save" title="保存 (Ctrl+S)">
                    <i class="icon-save"></i>
                </button>
                <button class="toolbar-btn" id="btn-export" title="导出">
                    <i class="icon-export"></i>
                </button>
                <button class="toolbar-btn" id="btn-versions" title="文档版本管理">
                    <i class="icon-versions"></i>
                </button>
            </div>
            
            <div class="toolbar-group git-group">
                <button class="toolbar-btn" id="btn-git-commit" title="提交到GitHub">
                    <i class="icon-git-commit"></i>
                </button>
                <button class="toolbar-btn" id="btn-git-pr" title="创建Pull Request">
                    <i class="icon-git-pr"></i>
                </button>
                <button class="toolbar-btn" id="btn-git-history" title="查看提交历史">
                    <i class="icon-git-history"></i>
                </button>
                <button class="toolbar-btn" id="btn-git-config" title="Git配置">
                    <i class="icon-git-config"></i>
                </button>
            </div>
        </div>

        <!-- 编辑器内容区域 -->
        <div class="editor-container">
            <!-- 左侧元数据编辑区 -->
            <div class="editor-sidebar">
                <div class="sidebar-header">
                    <h3>文档元数据</h3>
                    <div class="sidebar-actions">
                        <button type="button" id="validate-metadata" class="btn btn-sm btn-secondary" title="验证元数据">
                            <i class="icon-validate"></i> 验证
                        </button>
                        <button type="button" id="load-example" class="btn btn-sm btn-info" title="加载示例">
                            <i class="icon-example"></i> 示例
                        </button>
                    </div>
                </div>
                <div class="sidebar-content">
                    <div class="form-group">
                        <label for="doc-title">标题 <span class="required">*</span></label>
                        <input type="text" id="doc-title" class="form-input" placeholder="输入文档标题" required>
                    </div>
                    <div class="form-group">
                        <label for="doc-category">分类 <span class="required">*</span></label>
                        <select id="doc-category" class="form-select" required>
                            <option value="">选择分类</option>
                            <!-- 动态加载的分类选项将通过JavaScript添加 -->
                        </select>
                        <small class="form-help">从项目配置中加载</small>
                    </div>
                    <div class="form-group">
                        <label for="doc-difficulty">难度</label>
                        <select id="doc-difficulty" class="form-select">
                            <option value="">选择难度</option>
                            <option value="beginner">初级</option>
                            <option value="intermediate">中级</option>
                            <option value="advanced">高级</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="doc-author">作者</label>
                        <input type="text" id="doc-author" class="form-input" placeholder="输入作者名称">
                        <datalist id="author-suggestions">
                            <!-- 动态加载的作者建议将通过JavaScript添加 -->
                        </datalist>
                    </div>
                    <div class="form-group">
                        <label for="doc-date">日期</label>
                        <input type="date" id="doc-date" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="doc-tags">标签</label>
                        <input type="text" id="doc-tags" class="form-input" placeholder="输入标签，用逗号分隔">
                        <small class="form-help">格式：标签1, 标签2, 标签3</small>
                    </div>
                    <div class="form-group">
                        <label for="doc-description">描述</label>
                        <textarea id="doc-description" class="form-textarea" rows="4" placeholder="输入文档描述"></textarea>
                    </div>
                </div>
            </div>

            <!-- 中间Markdown编辑区 -->
            <div class="editor-pane">
                <div class="pane-header">
                    <h3>Markdown 编辑器</h3>
                    <div class="pane-status">
                        <span id="word-count">字数: 0</span>
                        <span id="line-count">行数: 0</span>
                    </div>
                </div>
                <div class="pane-content">
                    <textarea id="markdown-editor" class="markdown-editor" placeholder="在这里输入Markdown内容..."></textarea>
                </div>
            </div>

            <!-- 右侧预览区 -->
            <div class="preview-pane">
                <div class="pane-header">
                    <h3>预览</h3>
                    <div class="pane-controls">
                        <button class="btn btn-sm" id="btn-sync-scroll">同步滚动</button>
                    </div>
                </div>
                <div class="pane-content">
                    <div id="markdown-preview" class="markdown-preview"></div>
                </div>
            </div>
        </div>

        <!-- 编辑器状态栏 -->
        <div class="editor-statusbar">
            <div class="status-left">
                <span id="cursor-position">行 1, 列 1</span>
                <span id="file-path">未保存</span>
            </div>
            <div class="status-right">
                <span id="save-status">已保存</span>
                <span id="current-time"></span>
            </div>
        </div>
    </main>

    <!-- 导出对话框 -->
    <div id="export-dialog" class="dialog">
        <div class="dialog-content">
            <div class="dialog-header">
                <h3>导出文档</h3>
                <button class="dialog-close" id="close-export-dialog">&times;</button>
            </div>
            <div class="dialog-body">
                <div class="form-group">
                    <label for="export-format">导出格式</label>
                    <select id="export-format" class="form-select">
                        <option value="html">HTML (带样式)</option>
                        <option value="markdown">Markdown (带元数据)</option>
                        <option value="complete">完整文档 (所有版本)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="export-filename">文件名</label>
                    <input type="text" id="export-filename" class="form-input" placeholder="输入文件名（不含扩展名）">
                </div>
            </div>
            <div class="dialog-footer">
                <button class="btn btn-secondary" id="cancel-export">取消</button>
                <button class="btn btn-primary" id="confirm-export">导出</button>
            </div>
        </div>
    </div>

    <!-- 加载JavaScript文件 -->
    <script src="../assets/js/theme-toggle.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/marked.min.js"></script>
    <script src="../assets/js/prism.min.js"></script>
    <script src="../assets/js/prism-csharp.min.js"></script>
    
    <!-- CodeMirror JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/markdown/markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/yaml/yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/continuelist.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/mode/overlay.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/selection/active-line.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldcode.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/markdown-fold.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/searchcursor.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/search.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/search/jump-to-line.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/dialog/dialog.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.js"></script>
    
    <!-- 编辑器JavaScript -->
    <script src="../assets/js/markdown-editor.js"></script>
    
    <!-- 初始化编辑器 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化Markdown编辑器
            window.markdownEditor = new MarkdownEditor({
                editorElement: 'markdown-editor',
                previewElement: 'markdown-preview',
                toolbarSelector: '.editor-toolbar',
                statusbarSelector: '.editor-statusbar'
            });
            
            // 绑定验证元数据按钮
            const validateBtn = document.getElementById('validate-metadata');
            if (validateBtn) {
                validateBtn.addEventListener('click', function() {
                    const validation = window.markdownEditor.validateMetadata();
                    if (validation.isValid) {
                        window.markdownEditor.showSuccessMessage('元数据验证通过');
                    } else {
                        window.markdownEditor.showErrorMessage('元数据验证失败: ' + validation.errors.join(', '));
                    }
                });
            }
            
            // 绑定加载示例按钮
            const loadExampleBtn = document.getElementById('load-example');
            if (loadExampleBtn) {
                loadExampleBtn.addEventListener('click', function() {
                    // 加载示例文档
                    const exampleContent = `# 示例文档

## 概述
这是一个示例文档，展示了如何使用Markdown编辑器创建tModLoader教程。

## 代码示例
\`\`\`csharp
public class ExampleMod : Mod
{
    public override void Load()
    {
        // Mod加载时的代码
        Console.WriteLine("ExampleMod loaded!");
    }
}
\`\`\`

## 特殊功能
- <color=red>红色文本</color>
- <color=blue>蓝色文本</color>
- <color=green>绿色文本</color>

## 内部链接
这里是一个[内部文档链接](docs/螺线翻译tml教程/1-基础/0-Basic-Prerequisites-基础-先决条件.md)的示例。

## API引用
常用的API包括：\`Mod\`, \`ModPlayer\`, \`ModItem\`, \`Main.NewProjectile()\`等。

## 总结
这个示例展示了编辑器的各种功能。`;
                    
                    const exampleMetadata = {
                        title: '示例文档',
                        category: '基础',
                        difficulty: 'beginner',
                        author: '示例作者',
                        date: new Date().toISOString().split('T')[0],
                        tags: '示例, 教程, Markdown',
                        description: '这是一个展示编辑器功能的示例文档'
                    };
                    
                    window.markdownEditor.editor.setValue(exampleContent);
                    window.markdownEditor.setMetadata(exampleMetadata);
                    window.markdownEditor.updatePreview();
                    window.markdownEditor.showSuccessMessage('已加载示例文档');
                });
            }
            
            // 设置当前时间
            function updateTime() {
                const now = new Date();
                const timeString = now.toLocaleString('zh-CN');
                const timeElement = document.getElementById('current-time');
                if (timeElement) {
                    timeElement.textContent = timeString;
                }
            }
            
            updateTime();
            setInterval(updateTime, 1000);
            
            // 禁用路由系统，避免与编辑器冲突
            window.DISABLE_ROUTER = true;
        });
    </script>
</body>
</html>