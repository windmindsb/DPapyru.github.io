
<!DOCTYPE html>
<!-- å¢å¼ºç‰ˆæœç´¢ç»“æœé¡µé¢ -->
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœç´¢ç»“æœ - æ³°æ‹‰ç‘äºšModåˆ¶ä½œæ•™ç¨‹</title>
    
    <!-- SEOä¼˜åŒ–æ ‡ç­¾ -->
    <meta name="description" content="æ³°æ‹‰ç‘äºšModåˆ¶ä½œæ•™ç¨‹æœç´¢ç»“æœé¡µé¢ï¼Œæ”¯æŒé«˜çº§æœç´¢ã€æœç´¢å†å²å’Œæ™ºèƒ½å»ºè®®ã€‚">
    <meta name="keywords" content="æ³°æ‹‰ç‘äºš,Mod,æ•™ç¨‹,æœç´¢,tModLoader,C#,æ¸¸æˆå¼€å‘">
    <meta name="robots" content="index, follow">
    
    <!-- ä¸»é¢˜åˆ‡æ¢è„šæœ¬ - æ—©æœŸåŠ è½½ä»¥é¿å…é—ªçƒ -->
    <script>
        // ä¸»é¢˜åˆ‡æ¢æ—©æœŸåŠ è½½è„šæœ¬ - é˜²æ­¢é¡µé¢åŠ è½½æ—¶ä¸»é¢˜é—ªçƒ
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
    
    <!-- æ ·å¼å’Œå›¾æ ‡ -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/prism.min.css">
    <link rel="stylesheet" href="assets/css/vs2022-theme.css">
    <link rel="icon" type="image/png" href="assets/imgs/Green_tModLoader.png">
    
    <!-- æœç´¢ç»“æœé¡µé¢ä¸“ç”¨æ ·å¼ -->
    <style>
        /* æœç´¢é¡µé¢å®¹å™¨ */
        .search-page {
            padding: 80px 0;
            min-height: calc(100vh - 200px);
        }

        /* æœç´¢é¡µé¢å¤´éƒ¨ */
        .search-page-header {
            background-color: #fff;
            padding: 30px 0;
            border-bottom: 1px solid #e9ecef;
            margin-bottom: 30px;
        }

        .search-page-title {
            font-size: 2rem;
            color: #333;
            margin-bottom: 15px;
        }

        /* é«˜çº§æœç´¢è¡¨å• */
        .advanced-search-form {
            background-color: #fff;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .search-form-title {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-form-title::before {
            content: "ğŸ”";
            font-size: 1.2rem;
        }

        .search-input-group {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input-large {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 50px;
            font-size: 1.1rem;
            outline: none;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
        }

        .search-input-large:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.15);
            background-color: #fff;
        }

        .search-button-large {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: #007bff;
            border: none;
            color: white;
            cursor: pointer;
            padding: 12px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            width: 44px;
            height: 44px;
        }

        .search-button-large:hover {
            background: #0056b3;
            transform: translateY(-50%) scale(1.05);
        }

        /* æœç´¢é€‰é¡¹ */
        .search-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom:20px;
        }

        .search-option-group {
            display: flex;
            flex-direction: column;
        }

        .search-option-label {
            font-weight: 500;
            margin-bottom: 8px;
            color: #495057;
        }

        .search-option-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95rem;
            background-color: #fff;
        }

        /* æœç´¢å¸®åŠ© */
        .search-help {
            background-color: #a3e7a7;
            border: 2px solid #003309;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .search-help-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #000000;
        }

        .search-help-list {
            margin: 0;
            padding-left: 20px;
        }

        .search-help-list li {
            margin-bottom: 5px;
            color: #1d1d1d;
        }

        /* æœç´¢å†å² */
        .search-history {
            background-color: #fff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .search-history-title {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .clear-history-btn {
            background: none;
            border: none;
            color: #dc3545;
            cursor: pointer;
            font-size: 0.9rem;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .clear-history-btn:hover {
            background-color: #f8d7da;
        }

        .search-history-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .search-history-item {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 0.9rem;
            color: #495057;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .search-history-item:hover {
            background-color: #e9ecef;
            color: #007bff;
        }

        .search-history-item .remove {
            color: #6c757d;
            font-size: 0.8rem;
            margin-left: 5px;
        }

        /* æœç´¢ç»“æœç»Ÿè®¡ */
        .search-results-stats {
            background-color: #fff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-results-count {
            font-size: 1.1rem;
            color: #333;
        }

        .search-results-count strong {
            color: #007bff;
        }

        .search-sort {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-sort-label {
            font-weight: 500;
            color: #495057;
        }

        .search-sort-select {
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        /* æœç´¢ç»“æœåˆ—è¡¨ */
        .search-results-page {
            background-color: #fff;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .search-result-item-page {
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .search-result-item-page:last-child {
            border-bottom: none;
        }

        .search-result-item-page:hover {
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        .search-result-title-page {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #333;
        }

        .search-result-description-page {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .search-result-snippet {
            color: #555;
            margin-bottom: 15px;
            line-height: 1.5;
            font-size: 0.9rem;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid #007bff;
        }

        .search-result-snippet mark {
            background-color: #fff3cd;
            color: #856404;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }

        .search-result-meta-page {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .search-result-badge {
            padding:4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .search-result-score {
            background-color: #e7f3ff;
            color: #0056b3;
        }

        /* æ— æœç´¢ç»“æœ */
        .no-search-results {
            text-align: center;
            padding: 60px 20px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .no-results-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .no-results-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 10px;
        }

        .no-results-description {
            color: #666;
            margin-bottom: 20px;
        }

        .no-results-suggestions {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: left;
            max-width: 500px;
            margin: 0 auto;
        }

        .no-results-suggestions h4 {
            margin-bottom: 10px;
            color: #333;
        }

        .no-results-suggestions ul {
            margin: 0;
            padding-left: 20px;
        }

        .no-results-suggestions li {
            margin-bottom: 5px;
            color: #495057;
        }

        /* æœç´¢å»ºè®® */
        .search-suggestions-page {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #fff;
            border: 1px solid #e9ecef;
            border-top: none;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-top: 8px;
        }

        /* åˆ†é¡µæ§ä»¶ */
        .pagination-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            gap: 10px;
        }

        .pagination-button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            background-color: #fff;
            color: #333;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .pagination-button:hover {
            background-color: #f8f9fa;
        }

        .pagination-button.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }

        .pagination-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* æœç´¢è¿‡æ»¤å™¨ */
        .search-filters {
            background-color: #fff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .filter-toggle {
            background: none;
            border: none;
            color: #007bff;
            cursor: pointer;
            font-size: 0.9rem;
            margin-bottom: 15px;
            text-decoration: underline;
        }

        .filter-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-weight: 500;
            margin-bottom: 5px;
            color: #495057;
        }

        .filter-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .search-page {
                padding: 60px 0;
            }

            .search-page-title {
                font-size: 1.8rem;
            }

            .search-options {
                grid-template-columns: 1fr;
            }

            .search-results-stats {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .search-sort {
                width: 100%;
                justify-content: space-between;
            }
            
            .filter-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- ç½‘ç«™å¤´éƒ¨å¯¼èˆªåŒºåŸŸ -->
    <header class="site-header">
        <div class="container">
            <!-- å¤´éƒ¨å†…å®¹å®¹å™¨ï¼šåŒ…å«ç½‘ç«™logoã€å¯¼èˆªèœå•å’Œç§»åŠ¨ç«¯èœå•æŒ‰é’® -->
            <div class="header-content">
                <!-- ç½‘ç«™logoå’Œæ ‡é¢˜ -->
                <div class="logo">
                    <a href="index.html">
                        <img src="assets/imgs/Green_tModLoader.png" alt="æ³°æ‹‰ç‘äºšModåˆ¶ä½œæ•™ç¨‹" class="logo-image">
                        <h1 class="site-title">æ³°æ‹‰ç‘äºšModåˆ¶ä½œæ•™ç¨‹</h1>
                    </a>
                </div>
                <!-- ä¸»å¯¼èˆªèœå• -->
                <nav class="main-nav">
                    <ul class="nav-list">
                        <li class="nav-item"><a href="index.html" class="nav-link">é¦–é¡µ</a></li>
                        <li class="nav-item"><a href="docs/index.html" class="nav-link">æ–‡æ¡£</a></li>
                        <li class="nav-item"><a href="search-results-enhanced.html" class="nav-link active">æœç´¢</a></li>
                        <li class="nav-item"><a href="https://github.com/DPapyru/DPapyru.github.io" class="nav-link"
                                target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </nav>
                <!-- ç§»åŠ¨ç«¯èœå•åˆ‡æ¢æŒ‰é’® -->
                <button class="mobile-menu-toggle" aria-label="åˆ‡æ¢èœå•">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- æœç´¢é¡µé¢ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="search-page">
        <div class="container">
            <!-- æœç´¢é¡µé¢å¤´éƒ¨ -->
            <div class="search-page-header">
                <h1 class="search-page-title">æœç´¢æ•™ç¨‹</h1>
                <p class="search-page-description">ä½¿ç”¨é«˜çº§æœç´¢åŠŸèƒ½å¿«é€Ÿæ‰¾åˆ°æ‚¨éœ€è¦çš„æ•™ç¨‹å†…å®¹</p>
            </div>

            <!-- é«˜çº§æœç´¢è¡¨å• -->
            <div class="advanced-search-form">
                <h2 class="search-form-title">é«˜çº§æœç´¢</h2>
 
                <!-- æœç´¢è¾“å…¥æ¡† -->
                <div class="search-input-group">
                    <input type="text" class="search-input-large" id="advanced-search-input"
                        placeholder="è¾“å…¥æœç´¢å…³é”®è¯ï¼Œæ”¯æŒé«˜çº§è¯­æ³•..." autocomplete="off">
                    <button class="search-button-large" id="advanced-search-button">
                        <i class="icon-search"></i>
                    </button>
                    <div class="search-suggestions-page" id="advanced-search-suggestions"></div>
                </div>
 
                <!-- æœç´¢é€‰é¡¹ -->
                <div class="search-options">
                    <div class="search-option-group">
                        <label class="search-option-label" for="search-category">åˆ†ç±»</label>
                        <select class="search-option-select" id="search-category">
                            <option value="">å…¨éƒ¨åˆ†ç±»</option>
                            <option value="0-å¼€å§‹">å¼€å§‹</option>
                            <option value="1-åŸºç¡€">åŸºç¡€</option>
                            <option value="2-ä¸­é˜¶">ä¸­é˜¶</option>
                            <option value="3-é«˜é˜¶">é«˜é˜¶</option>
                            <option value="4-ä¸“å®¶">ä¸“å®¶</option>
                            <option value="å…¥é—¨">å…¥é—¨</option>
                            <option value="è¿›é˜¶">è¿›é˜¶</option>
                            <option value="é«˜çº§">é«˜çº§</option>
                            <option value="ä¸ªäººåˆ†äº«">ä¸ªäººåˆ†äº«</option>
                        </select>
                    </div>
                    <div class="search-option-group">
                        <label class="search-option-label" for="search-difficulty">éš¾åº¦</label>
                        <select class="search-option-select" id="search-difficulty">
                            <option value="">å…¨éƒ¨éš¾åº¦</option>
                            <option value="beginner">åˆçº§</option>
                            <option value="intermediate">ä¸­çº§</option>
                            <option value="advanced">é«˜çº§</option>
                        </select>
                    </div>
                    <div class="search-option-group">
                        <label class="search-option-label" for="search-sort">æ’åºæ–¹å¼</label>
                        <select class="search-option-select" id="search-sort">
                            <option value="relevance">ç›¸å…³æ€§</option>
                            <option value="title">æ ‡é¢˜</option>
                            <option value="date">æ—¥æœŸ</option>
                            <option value="difficulty">éš¾åº¦</option>
                        </select>
                    </div>
                </div>
 
                <!-- æœç´¢è¿‡æ»¤å™¨åˆ‡æ¢ -->
                <div class="filter-toggle" id="filter-toggle">
                    æ˜¾ç¤ºé«˜çº§è¿‡æ»¤å™¨
                </div>
                
                <!-- é«˜çº§è¿‡æ»¤å™¨é€‰é¡¹ -->
                <div class="filter-options" id="filter-options" style="display: none;">
                    <div class="filter-group">
                        <label class="filter-label" for="filter-author">ä½œè€…</label>
                        <input type="text" class="filter-input" id="filter-author" placeholder="è¾“å…¥ä½œè€…åç§°">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filter-tags">æ ‡ç­¾</label>
                        <input type="text" class="filter-input" id="filter-tags" placeholder="è¾“å…¥æ ‡ç­¾ï¼Œç”¨é€—å·åˆ†éš”">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filter-date-from">å¼€å§‹æ—¥æœŸ</label>
                        <input type="date" class="filter-input" id="filter-date-from">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filter-date-to">ç»“æŸæ—¥æœŸ</label>
                        <input type="date" class="filter-input" id="filter-date-to">
                    </div>
                </div>
 
                <!-- æœç´¢å¸®åŠ© -->
                <div class="search-help">
                    <h3 class="search-help-title">æœç´¢è¯­æ³•å¸®åŠ©</h3>
                    <ul class="search-help-list">
                        <li><strong>åŸºæœ¬æœç´¢ï¼š</strong>ç›´æ¥è¾“å…¥å…³é”®è¯ï¼Œå¦‚ "ç‰©å“åˆ›å»º"</li>
                        <li><strong>ANDé€»è¾‘ï¼š</strong>ä½¿ç”¨ "+" è¿æ¥å…³é”®è¯ï¼Œå¦‚ "ç‰©å“ + åˆ›å»º"</li>
                        <li><strong>ORé€»è¾‘ï¼š</strong>ä½¿ç”¨ç©ºæ ¼åˆ†éš”å…³é”®è¯ï¼Œå¦‚ "ç‰©å“ åˆ›å»º"</li>
                        <li><strong>æ’é™¤è¯ï¼š</strong>ä½¿ç”¨ "-" æ’é™¤å…³é”®è¯ï¼Œå¦‚ "ç‰©å“ - åˆ›å»º"</li>
                        <li><strong>ç²¾ç¡®åŒ¹é…ï¼š</strong>ä½¿ç”¨å¼•å·åŒ…å›´å…³é”®è¯ï¼Œå¦‚ "Modåˆ¶ä½œ"</li>
                        <li><strong>é€šé…ç¬¦ï¼š</strong>ä½¿ç”¨ "*" åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œå¦‚ "Mod*"</li>
                        <li><strong>å­—æ®µæœç´¢ï¼š</strong>ä½¿ç”¨ "å­—æ®µ:å€¼" æ ¼å¼ï¼Œå¦‚ "title:ç‰©å“"</li>
                    </ul>
                </div>
            </div>
 
            <!-- æœç´¢å†å² -->
            <div class="search-history" id="search-history-container">
                <div class="search-history-title">
                    <span>æœç´¢å†å²</span>
                    <button class="clear-history-btn" id="clear-history-btn">æ¸…é™¤å†å²</button>
                </div>
                <div class="search-history-list" id="search-history-list">
                    <!-- æœç´¢å†å²é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
            </div>
 
            <!-- æœç´¢ç»“æœç»Ÿè®¡ -->
            <div class="search-results-stats" id="search-results-stats" style="display: none;">
                <div class="search-results-count">
                    æ‰¾åˆ° <strong id="results-count">0</strong> ä¸ªç›¸å…³ç»“æœ
                </div>
                <div class="search-sort">
                    <label class="search-sort-label" for="results-sort">æ’åºï¼š</label>
                    <select class="search-sort-select" id="results-sort">
                        <option value="relevance">ç›¸å…³æ€§</option>
                        <option value="title">æ ‡é¢˜</option>
                        <option value="date">æ—¥æœŸ</option>
                        <option value="difficulty">éš¾åº¦</option>
                    </select>
                </div>
            </div>
 
            <!-- æœç´¢ç»“æœåˆ—è¡¨ -->
            <div class="search-results-page" id="search-results-container" style="display: none;">
                <!-- æœç´¢ç»“æœé¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
            </div>
            
            <!-- åˆ†é¡µæ§ä»¶ -->
            <div class="pagination-container" id="pagination-container" style="display: none;">
                <!-- åˆ†é¡µæŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
            </div>
 
            <!-- æ— æœç´¢ç»“æœæç¤º -->
            <div class="no-search-results" id="no-search-results" style="display: none;">
                <div class="no-results-icon">ğŸ”</div>
                <h2 class="no-results-title">æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</h2>
                <p class="no-results-description">æˆ‘ä»¬æ‰¾ä¸åˆ°ä¸æ‚¨çš„æœç´¢è¯åŒ¹é…çš„æ•™ç¨‹å†…å®¹</p>
                <div class="no-results-suggestions">
                    <h4>æœç´¢å»ºè®®ï¼š</h4>
                    <ul>
                        <li>æ£€æŸ¥æ‹¼å†™æ˜¯å¦æ­£ç¡®</li>
                        <li>å°è¯•ä½¿ç”¨ä¸åŒçš„å…³é”®è¯</li>
                        <li>ä½¿ç”¨æ›´é€šç”¨çš„æœç´¢è¯</li>
                        <li>ä½¿ç”¨é«˜çº§æœç´¢è¯­æ³•ï¼Œå¦‚ "ç‰©å“ + åˆ›å»º"</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>
 
    <!-- ç½‘ç«™åº•éƒ¨åŒºåŸŸ -->
    <footer class="site-footer">
        <div class="container">
            <!-- åº•éƒ¨å†…å®¹å®¹å™¨ -->
            <div class="footer-content">
                <!-- åº•éƒ¨ç¬¬ä¸€æ ï¼šå…³äºé¡¹ç›® -->
                <div class="footer-section">
                    <h4>å…³äºé¡¹ç›®</h4>
                    <p>è¿™æ˜¯ä¸€ä¸ªé¢å‘æ³°æ‹‰ç‘äºšModå¼€å‘è€…çš„åä½œæ•™ç¨‹é¡¹ç›®ï¼Œæ—¨åœ¨é™ä½Modåˆ¶ä½œé—¨æ§›ã€‚</p>
                </div>
                <!-- åº•éƒ¨ç¬¬äºŒæ ï¼šå¿«é€Ÿé“¾æ¥ -->
                <div class="footer-section">
                    <h4>å¿«é€Ÿé“¾æ¥</h4>
                    <ul>
                        <li><a href="index.html">é¦–é¡µ</a></li>
                        <li><a href="docs/tutorial-index.md">æ•™ç¨‹ç´¢å¼•</a></li>
                        <li><a href="docs/0-å¼€å§‹/0-Home ä¸»é¡µ.md">å…¥é—¨æŒ‡å—</a></li>
                        <li><a href="docs/1-åŸºç¡€/0-Basic-Prerequisites åŸºç¡€-å…ˆå†³æ¡ä»¶.md">åŸºç¡€æ¦‚å¿µ</a></li>
                        <li><a href="https://github.com/DPapyru/DPapyru.github.io" target="_blank" rel="noopener">GitHub</a></li>
                    </ul>
                </div>
                <!-- åº•éƒ¨ç¬¬ä¸‰æ ï¼šè”ç³»æˆ‘ä»¬ -->
                <div class="footer-section">
                    <h4>è”ç³»æˆ‘ä»¬</h4>
                    <ul>
                        <li><a href="https://github.com/DPapyru/DPapyru.github.io" target="_blank" rel="noopener">GitHub</a></li>
                        <li><a href="mailto:contact@example.com">é‚®ç®±</a></li>
                    </ul>
                </div>
            </div>
            <!-- åº•éƒ¨ç‰ˆæƒä¿¡æ¯ -->
            <div class="footer-bottom">
                <p>&copy; 2023 æ³°æ‹‰ç‘äºšModåˆ¶ä½œæ•™ç¨‹. é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">CC
                        BY 4.0</a> è®¸å¯åè®®ã€‚</p>
            </div>
        </div>
    </footer>
 
    <!-- åŠ è½½JavaScriptæ–‡ä»¶ -->
    <script src="assets/js/theme-toggle.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/search.js"></script>
    <script src="assets/js/navigation.js"></script>
 
    <!-- æœç´¢ç»“æœé¡µé¢ä¸“ç”¨è„šæœ¬ -->
    <script>
        // æœç´¢ç»“æœé¡µé¢åŠŸèƒ½
        class EnhancedSearchResultsPage {
            constructor() {
                this.searchHistory = this.loadSearchHistory();
                this.currentQuery = this.getQueryFromURL();
                this.searchIndex = [];
                this.searchResults = [];
                this.filteredResults = [];
                this.currentPage = 1;
                this.resultsPerPage = 10;
                this.init();
            }
 
            // åˆå§‹åŒ–
            async init() {
                this.bindEvents();
                await this.loadSearchIndex();
                this.displaySearchHistory();
 
                // å¦‚æœURLä¸­æœ‰æŸ¥è¯¢å‚æ•°ï¼Œæ‰§è¡Œæœç´¢
                if (this.currentQuery) {
                    document.getElementById('advanced-search-input').value = this.currentQuery;
                    this.performSearch();
                }
            }
 
            // ç»‘å®šäº‹ä»¶
            bindEvents() {
                const searchInput = document.getElementById('advanced-search-input');
                const searchButton = document.getElementById('advanced-search-button');
                const clearHistoryBtn = document.getElementById('clear-history-btn');
                const resultsSort = document.getElementById('results-sort');
                const searchCategory = document.getElementById('search-category');
                const searchDifficulty = document.getElementById('search-difficulty');
                const searchSort = document.getElementById('search-sort');
                const filterToggle = document.getElementById('filter-toggle');
                const filterOptions = document.getElementById('filter-options');
                
                // æœç´¢è¾“å…¥äº‹ä»¶
                searchInput.addEventListener('input', debounce((e) => {
                    this.handleSearchInput(e.target.value);
                }, 300));
 
                searchInput.addEventListener('focus', () => {
                    this.showSearchSuggestions();
                });
 
                searchInput.addEventListener('keydown', (e) => {
                    this.handleKeydown(e);
                });
 
                // æœç´¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                searchButton.addEventListener('click', () => {
                    this.performSearch();
                });
 
                // æ¸…é™¤å†å²æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                clearHistoryBtn.addEventListener('click', () => {
                    this.clearSearchHistory();
                });
 
                // æ’åºé€‰æ‹©äº‹ä»¶
                resultsSort.addEventListener('change', () => {
                    this.sortSearchResults(resultsSort.value);
                });
 
                // ç­›é€‰é€‰é¡¹å˜åŒ–äº‹ä»¶
                searchCategory.addEventListener('change', () => {
                    this.filterSearchResults();
                });
 
                searchDifficulty.addEventListener('change', () => {
                    this.filterSearchResults();
                });
 
                searchSort.addEventListener('change', () => {
                    this.performSearch();
                });
 
                // è¿‡æ»¤å™¨åˆ‡æ¢
                filterToggle.addEventListener('click', () => {
                    const isVisible = filterOptions.style.display !== 'none';
                    filterOptions.style.display = isVisible ? 'none' : 'grid';
                    filterToggle.textContent = isVisible ? 'æ˜¾ç¤ºé«˜çº§è¿‡æ»¤å™¨' : 'éšè—é«˜çº§è¿‡æ»¤å™¨';
                });
 
                // é«˜çº§è¿‡æ»¤å™¨å˜åŒ–äº‹ä»¶
                const filterInputs = ['filter-author', 'filter-tags', 'filter-date-from', 'filter-date-to'];
                filterInputs.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('change', () => {
                            this.applyAdvancedFilters();
                        });
                    }
                });
 
                // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹éšè—æœç´¢å»ºè®®
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.search-input-group')) {
                        this.hideSearchSuggestions();
                    }
                });
            }
 
            // ä»URLè·å–æŸ¥è¯¢å‚æ•°
            getQueryFromURL() {
                const urlParams = new URLSearchParams(window.location.search);
                const query = urlParams.get('q') || '';
                console.log('ä»URLè·å–çš„åŸå§‹æŸ¥è¯¢:', query);
                // è§£ç URLç¼–ç çš„å­—ç¬¦
                const decodedQuery = decodeURIComponent(query);
                console.log('è§£ç åçš„æŸ¥è¯¢:', decodedQuery);
                return decodedQuery;
            }
 
            // æ›´æ–°URL
            updateURL(query) {
                const url = new URL(window.location);
                if (query) {
                    url.searchParams.set('q', query);
                } else {
                    url.searchParams.delete('q');
                }
                window.history.replaceState({}, '', url);
            }
 
            // åŠ è½½æœç´¢ç´¢å¼•
            async loadSearchIndex() {
                try {
                    // é¦–å…ˆå°è¯•ä»config.jsonè·å–æ–‡æ¡£åˆ—è¡¨
                    let tutorialFiles = await this.getTutorialFilesFromConfig();
 
                    // å¦‚æœconfig.jsonè·å–å¤±è´¥æˆ–ä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤è·¯å¾„
                    if (!tutorialFiles || tutorialFiles.length === 0) {
                        tutorialFiles = await this.getTutorialFiles();
                    }
 
                    // ä¸ºæ¯ä¸ªæ–‡ä»¶åˆ›å»ºç´¢å¼•
                    for (const file of tutorialFiles) {
                        try {
                            const response = await fetch(file); // ä½¿ç”¨fetchè·å–æ–‡ä»¶å†…å®¹
                            if (!response.ok) continue;
 
                            const content = await response.text(); // ä½¿ç”¨text()æ–¹æ³•è·å–æ–‡ä»¶å†…å®¹
                            const metadata = await this.parseMetadataWithConfig(content, file.split('/').pop()); // ä½¿ç”¨parseMetadataWithConfigæ–¹æ³•è§£ææ–‡ä»¶å…ƒæ•°æ®
                            const plainText = this.stripMarkdown(content); // ä½¿ç”¨stripMarkdownæ–¹æ³•å»é™¤Markdownæ ¼å¼
 
                            // æ›´æ–°URLï¼Œä½¿å…¶æŒ‡å‘viewer.htmlå¹¶åŠ è½½ç›¸åº”çš„æ–‡ä»¶
                            const viewerUrl = `docs/viewer.html?file=${file.replace('docs/', '').split('/').pop()}`;
                            console.log('æ›´æ–°åçš„URL:', viewerUrl);
 
                            this.searchIndex.push({
                                title: metadata.title || this.extractTitle(content),
                                url: viewerUrl,
                                content: plainText,
                                description: metadata.description || this.extractDescription(plainText),
                                category: metadata.category || this.getCategoryFromPath(file),
                                difficulty: metadata.difficulty || 'æœªçŸ¥',
                                time: metadata.time || metadata.estimated_time || 'æœªçŸ¥',
                                author: metadata.author || 'æœªçŸ¥',
                                date: metadata.date || metadata.last_updated || 'æœªçŸ¥',
                                path: metadata.path || '',
                                tags: metadata.tags || []
                            });
                        } catch (error) {
                            console.warn(`æ— æ³•åŠ è½½æ–‡ä»¶ ${file}:`, error);
                        }
                    }
 
                    console.log(`æœç´¢ç´¢å¼•åŠ è½½å®Œæˆï¼Œå…± ${this.searchIndex.length} ä¸ªæ•™ç¨‹`);
                } catch (error) {
                    console.error('åŠ è½½æœç´¢ç´¢å¼•å¤±è´¥:', error);
                }
            }
 
            // ä»config.jsonè·å–æ‰€æœ‰æ•™ç¨‹æ–‡ä»¶
            async getTutorialFilesFromConfig() {
                try {
                    const response = await fetch('docs/config.json');
                    if (!response.ok) {
                        throw new Error(`æ— æ³•åŠ è½½config.json: ${response.status}`);
                    }
                    const config = await response.json();
 
                    // ä»config.jsonä¸­æå–æ‰€æœ‰æ–‡æ¡£æ–‡ä»¶
                    const documents = [];
 
                    // ä½¿ç”¨all_filesæ•°ç»„ï¼Œè¿™æ˜¯æœ€ç›´æ¥çš„æ–‡æ¡£åˆ—è¡¨
                    if (config.all_files && Array.isArray(config.all_files)) {
                        config.all_files.forEach(file => {
                            documents.push(`docs/${file.path}`);
                        });
                    } else {
                        // å¦‚æœall_filesä¸å­˜åœ¨ï¼Œå›é€€åˆ°éå†ç±»åˆ«å’Œä¸»é¢˜
                        Object.values(config.categories).forEach(category => {
                            Object.values(category.topics).forEach(topic => {
                                topic.files.forEach(file => {
                                    documents.push(`docs/${file.filename}`);
                                });
                            });
                        });
                    }
 
                    console.log('ä»config.jsonè·å–çš„æ–‡æ¡£åˆ—è¡¨:', documents);
                    return documents;
                } catch (error) {
                    console.error('è·å–config.jsonå¤±è´¥:', error);
                    return []; // è¿”å›ç©ºæ•°ç»„ï¼Œè®©è°ƒç”¨è€…ä½¿ç”¨é»˜è®¤è·¯å¾„
                }
            }
 
            // è·å–æ‰€æœ‰æ•™ç¨‹æ–‡ä»¶ï¼ˆé»˜è®¤åå¤‡æ–¹æ¡ˆï¼‰
            async getTutorialFiles() {
                // è¿”å›æ‰€æœ‰æ•™ç¨‹æ–‡ä»¶çš„è·¯å¾„ - æ›´æ–°ä¸ºæ–°çš„æ‰å¹³åŒ–æ–‡æ¡£ç»“æ„
                return [
                    'docs/DPapyru-ForNewModder.md',
                    'docs/DPapyru-ForContributors-Basic.md',
                    'docs/TopicSystemGuide.md',
                    'docs/tutorial-index.md',
                    'docs/test.md'
                ];
            }
 
            // è§£ææ–‡ä»¶å…ƒæ•°æ® - å¢å¼ºç‰ˆï¼Œæ”¯æŒä»config.jsonè·å–å…ƒæ•°æ®
            async parseMetadataWithConfig(content, fileName) {
                let metadata = this.parseMetadata(content);
 
                // å°è¯•ä»config.jsonè·å–æ›´å®Œæ•´çš„å…ƒæ•°æ®
                try {
                    const response = await fetch('docs/config.json');
                    if (response.ok) {
                        const config = await response.json();
 
                        // åœ¨all_filesä¸­æŸ¥æ‰¾å½“å‰æ–‡ä»¶
                        const fileInfo = config.all_files.find(file => file.filename === fileName);
                        if (fileInfo) {
                            // åˆå¹¶config.jsonä¸­çš„å…ƒæ•°æ®
                            metadata = {
                                ...metadata,
                                title: fileInfo.title || metadata.title,
                                author: fileInfo.author || metadata.author,
                                category: fileInfo.category || metadata.category,
                                topic: fileInfo.topic || metadata.topic,
                                order: fileInfo.order || metadata.order,
                                path: fileInfo.path || metadata.path,
                                tags: fileInfo.tags || metadata.tags
                            };
 
                            // ä»categoriesä¸­è·å–æ›´å¤šä¿¡æ¯
                            if (fileInfo.category && config.categories[fileInfo.category]) {
                                const categoryInfo = config.categories[fileInfo.category];
                                if (categoryInfo.topics[fileInfo.topic]) {
                                    const topicInfo = categoryInfo.topics[fileInfo.topic];
                                    const fileInTopic = topicInfo.files.find(f => f.filename === fileName);
                                    if (fileInTopic) {
                                        metadata = {
                                            ...metadata,
                                            title: fileInTopic.title || metadata.title,
                                            author: fileInTopic.author || metadata.author,
                                            description: fileInTopic.description || metadata.description,
                                            last_updated: fileInTopic.last_updated || metadata.last_updated,
                                            order: fileInTopic.order || metadata.order,
                                            path: fileInfo.path || metadata.path,
                                        };
                                    }
                                }
                            }
                        }
                    }
                } catch (error) {
                    console.warn('ä»config.jsonè·å–å…ƒæ•°æ®å¤±è´¥:', error);
                }
 
                return metadata;
            }
 
            // ä»æ–‡ä»¶è·¯å¾„è·å–åˆ†ç±»
            getCategoryFromPath(filePath) {
                const match = filePath.match(/docs\/([^\/]+)/);
                return match ? match[1] : 'æœªåˆ†ç±»';
            }
 
            // è§£ææ–‡ä»¶å…ƒæ•°æ®
            parseMetadata(content) {
                const metadataMatch = content.match(/^---\n(.*?)\n---/s);
                if (!metadataMatch) return {};
 
                const metadata = {};
                const lines = metadataMatch[1].split('\n');
 
                lines.forEach(line => {
                    const [key, ...valueParts] = line.split(':');
                    if (key && valueParts.length > 0) {
                        metadata[key.trim()] = valueParts.join(':').trim();
                    }
                });
 
                // å¤„ç†æ–°æ–‡æ¡£ç»“æ„ä¸­çš„å…ƒæ•°æ®å­—æ®µæ˜ å°„
                // å°†estimated_timeæ˜ å°„åˆ°timeï¼Œå°†last_updatedæ˜ å°„åˆ°date
                if (metadata.estimated_time && !metadata.time) {
                    metadata.time = metadata.estimated_time;
                }
                if (metadata.last_updated && !metadata.date) {
                    metadata.date = metadata.last_updated;
                }
 
                return metadata;
            }
 
            // æå–æ ‡é¢˜
            extractTitle(content) {
                const titleMatch = content.match(/^#\s+(.+)$/m);
                return titleMatch ? titleMatch[1] : 'æ— æ ‡é¢˜';
            }
 
            // æå–æè¿°
            extractDescription(plainText) {
                // å–å‰100ä¸ªå­—ç¬¦ä½œä¸ºæè¿°
                return plainText.substring(0, 100).trim() + '...';
            }
 
            // å¤„ç†æœç´¢è¾“å…¥
            handleSearchInput(query) {
                this.currentQuery = query.trim();
 
                if (this.currentQuery) {
                    this.showSearchSuggestions();
                } else {
                    this.hideSearchSuggestions();
                }
            }
 
            // æ˜¾ç¤ºæœç´¢å»ºè®®
            showSearchSuggestions() {
                if (!this.currentQuery) return;
 
                const suggestions = this.getSuggestions(this.currentQuery);
                const suggestionsContainer = document.getElementById('advanced-search-suggestions');
 
                if (suggestions.length === 0) {
                    suggestionsContainer.style.display = 'none';
                    return;
                }
 
                suggestionsContainer.innerHTML = '';
 
                suggestions.forEach(suggestion => {
                    const item = document.createElement('div');
                    item.className = 'suggestion-item';
                    item.innerHTML = this.highlightText(suggestion.title, this.currentQuery);
 
                    item.addEventListener('click', () => {
                        document.getElementById('advanced-search-input').value = suggestion.title;
                        this.currentQuery = suggestion.title;
                        this.performSearch();
                    });
 
                    suggestionsContainer.appendChild(item);
                });
 
                suggestionsContainer.style.display = 'block';
            }
 
            // éšè—æœç´¢å»ºè®®
            hideSearchSuggestions() {
                const suggestionsContainer = document.getElementById('advanced-search-suggestions');
                if (suggestionsContainer) {
                    suggestionsContainer.style.display = 'none';
                }
            }
 
            // è·å–æœç´¢å»ºè®®
            getSuggestions(query) {
                if (!query) return [];
 
                const lowerQuery = query.toLowerCase();
                return this.searchIndex
                    .filter(item => (item.title || '').toLowerCase().includes(lowerQuery))
                    .slice(0, 5); // æœ€å¤šæ˜¾ç¤º5ä¸ªå»ºè®®
            }
 
            // å¤„ç†é”®ç›˜äº‹ä»¶
            handleKeydown(e) {
                const suggestionsContainer = document.getElementById('advanced-search-suggestions');
                if (!suggestionsContainer) return;
 
                const suggestions = suggestionsContainer.querySelectorAll('.suggestion-item');
 
                if (e.key === 'Enter') {
                    e.preventDefault();
                    this.performSearch();
                } else if (e.key === 'Escape') {
                    this.hideSearchSuggestions();
                }
            }
 
            // æ‰§è¡Œæœç´¢
            async performSearch() {
                if (!this.currentQuery) return;
 
                // æ·»åŠ åˆ°æœç´¢å†å²
                this.addToSearchHistory(this.currentQuery);
 
                // æ›´æ–°URL
                this.updateURL(this.currentQuery);
 
                // éšè—æœç´¢å»ºè®®
                this.hideSearchSuggestions();
 
                // æ‰§è¡Œé«˜çº§æœç´¢
                this.searchResults = this.advancedSearch(this.currentQuery);
                this.filteredResults = [...this.searchResults];
                this.currentPage = 1;
 
                // æ˜¾ç¤ºæœç´¢ç»“æœ
                this.displaySearchResults();
            }
 
            // é«˜çº§æœç´¢ç®—æ³•
            advancedSearch(query) {
                if (!query) return [];
 
                // è§£ææœç´¢æŸ¥è¯¢
                const searchQuery = this.parseSearchQuery(query);
 
                const results = [];
 
                this.searchIndex.forEach(item => {
                    const score = this.calculateRelevanceScore(item, searchQuery);
 
                    if (score > 0) {
                        // ç”ŸæˆåŒ¹é…ç‰‡æ®µ
                        const snippet = this.generateSnippet(item.content, searchQuery);
 
                        results.push({
                            ...item,
                            score,
                            snippet
                        });
                    }
                });
 
                // æŒ‰å¾—åˆ†æ’åº
                return results.sort((a, b) => b.score - a.score);
            }
 
            // è§£ææœç´¢æŸ¥è¯¢ - å¢å¼ºç‰ˆ
            parseSearchQuery(query) {
                // è¿™æ˜¯ä¸€ä¸ªå¢å¼ºçš„æŸ¥è¯¢è§£æå™¨ï¼Œæ”¯æŒæ›´å¤šçš„æœç´¢è¯­æ³•
 
                // æ·»åŠ è°ƒè¯•æ—¥å¿—
                console.log('æœç´¢ç»“æœé¡µé¢ - åŸå§‹æŸ¥è¯¢:', query);
 
                // å¤„ç†URLç¼–ç çš„å­—ç¬¦
                query = decodeURIComponent(query);
                console.log('æœç´¢ç»“æœé¡µé¢ - è§£ç åæŸ¥è¯¢:', query);
 
                // ç§»é™¤å¤šä½™çš„ç©ºæ ¼
                query = query.trim().replace(/\s+/g, ' ');
                console.log('æœç´¢ç»“æœé¡µé¢ - è§„èŒƒåŒ–åæŸ¥è¯¢:', query);
 
                // å¤„ç†ç²¾ç¡®åŒ¹é…ï¼ˆå¼•å·åŒ…å›´çš„çŸ­è¯­ï¼‰
                const exactMatches = [];
                const exactMatchRegex = /"([^"]+)"/g;
                let match;
                while ((match = exactMatchRegex.exec(query)) !== null) {
                    exactMatches.push(match[1].toLowerCase());
                }
                console.log('æœç´¢ç»“æœé¡µé¢ - ç²¾ç¡®åŒ¹é…é¡¹:', exactMatches);
 
                // ç§»é™¤ç²¾ç¡®åŒ¹é…éƒ¨åˆ†ï¼Œå¤„ç†å‰©ä½™æŸ¥è¯¢
                query = query.replace(/"[^"]+"/g, '').trim();
 
                // å¤„ç†æ’é™¤è¯ï¼ˆ-å·å¼€å¤´çš„è¯ï¼‰
                const excludeTerms = [];
                const excludeTermRegex = /-(\S+)/g;
                while ((match = excludeTermRegex.exec(query)) !== null) {
                    excludeTerms.push(match[1].toLowerCase());
                }
                console.log('æœç´¢ç»“æœé¡µé¢ - æ’é™¤é¡¹:', excludeTerms);
 
                // ç§»é™¤æ’é™¤è¯éƒ¨åˆ†
                query = query.replace(/-\S+/g, '').trim();
 
                // å¤„ç†é€šé…ç¬¦ï¼ˆ*å·ï¼‰
                const wildcardTerms = [];
                const wildcardTermRegex = /(\S+\*)/g;
                while ((match = wildcardTermRegex.exec(query)) !== null) {
                    wildcardTerms.push(match[1].toLowerCase().replace('*', ''));
                }
                console.log('æœç´¢ç»“æœé¡µé¢ - é€šé…ç¬¦é¡¹:', wildcardTerms);
 
                // ç§»é™¤é€šé…ç¬¦éƒ¨åˆ†
                query = query.replace(/\S+\*/g, '').trim();
 
                // å¤„ç†å­—æ®µæœç´¢ï¼ˆå­—æ®µ:å€¼æ ¼å¼ï¼‰
                const fieldSearches = {};
                const fieldSearchRegex = /(\w+):(\S+)/g;
                while ((match = fieldSearchRegex.exec(query)) !== null) {
                    const field = match[1].toLowerCase();
                    const value = match[2].toLowerCase();
                    if (!fieldSearches[field]) {
                        fieldSearches[field] = [];
                    }
                    fieldSearches[field].push(value);
                }
                console.log('æœç´¢ç»“æœé¡µé¢ - å­—æ®µæœç´¢:', fieldSearches);
 
                // ç§»é™¤å­—æ®µæœç´¢éƒ¨åˆ†
                query = query.replace(/\w+:\S+/g, '').trim();
 
                // å¤„ç†æ‹¬å·ç»„ï¼ˆå…ˆå¤„ç†æ‹¬å·ï¼Œå› ä¸ºæ‹¬å·å†…å¯èƒ½åŒ…å«AND/ORæ“ä½œï¼‰
                const bracketGroups = [];
                const bracketRegex = /\(([^)]+)\)/g;
                while ((match = bracketRegex.exec(query)) !== null) {
                    bracketGroups.push(match[1].toLowerCase());
                }
                console.log('æœç´¢ç»“æœé¡µé¢ - æ‹¬å·ç»„:', bracketGroups);
 
                // ç§»é™¤æ‹¬å·éƒ¨åˆ†
                query = query.replace(/\([^)]+\)/g, '').trim();
 
                // å¤„ç†ANDæ“ä½œï¼ˆ+å·ï¼‰
                const andTerms = [];
                const andTermRegex = /\+([^\s+]+)/g;
                while ((match = andTermRegex.exec(query)) !== null) {
                    andTerms.push(match[1].toLowerCase());
                }
                console.log('æœç´¢ç»“æœé¡µé¢ - ANDé¡¹:', andTerms);
 
                // ç§»é™¤ANDæ“ä½œéƒ¨åˆ†
                query = query.replace(/\+[^\s+]+/g, '').trim();
 
                // å‰©ä½™çš„éƒ¨åˆ†ä½œä¸ºORæ“ä½œ
                const orTerms = query ? query.split(' ').filter(term => term) : [];
                console.log('æœç´¢ç»“æœé¡µé¢ - ORé¡¹:', orTerms);
 
                return {
                    exactMatches,
                    excludeTerms,
                    wildcardTerms,
                    fieldSearches,
                    andTerms,
                    orTerms,
                    bracketGroups,
                    originalQuery: query
                };
            }
 
            // è®¡ç®—ç›¸å…³æ€§å¾—åˆ† - å¢å¼ºç‰ˆ
            calculateRelevanceScore(item, searchQuery) {
                let score = 0;
                const title = (item.title || '').toLowerCase();
                const content = (item.content || '').toLowerCase();
                const description = (item.description || '').toLowerCase();
                const category = (item.category || '').toLowerCase();
                const tags = (item.tags || []).map(tag => tag.toLowerCase());
                const author = (item.author || '').toLowerCase();
 
                // æ”¶é›†æ‰€æœ‰æœç´¢è¯
                const allTerms = [
                    ...searchQuery.exactMatches,
                    ...searchQuery.andTerms,
                    ...searchQuery.orTerms,
                    ...searchQuery.bracketGroups.flatMap(group => group.split(' ')),
                    ...searchQuery.wildcardTerms
                ].filter(term => term.trim() !== '');
 
                // å­—æ®µæœç´¢å¾—åˆ†æœ€é«˜
                if (searchQuery.fieldSearches.title && searchQuery.fieldSearches.title.some(term => title.includes(term))) {
                    score += 100;
                }
                if (searchQuery.fieldSearches.author && searchQuery.fieldSearches.author.some(term => author.includes(term))) {
                    score += 80;
                }
                if (searchQuery.fieldSearches.category && searchQuery.fieldSearches.category.some(term => category.includes(term))) {
                    score += 60;
                }
                if (searchQuery.fieldSearches.tags && searchQuery.fieldSearches.tags.some(term => 
                    tags.some(tag => tag.includes(term))
                )) {
                    score += 70;
                }
                if (searchQuery.fieldSearches.content && searchQuery.fieldSearches.content.some(term => content.includes(term))) {
                    score += 50;
                }
 
                // ç²¾ç¡®åŒ¹é…å¾—åˆ†æœ€é«˜
                searchQuery.exactMatches.forEach(term => {
                    if (title.includes(term)) score += 50;
                    if (description.includes(term)) score += 25;
                    if (content.includes(term)) score += 10;
                    if (category.includes(term)) score += 15;
                    if (tags.some(tag => tag.includes(term))) score += 20;
                });
 
                // é€šé…ç¬¦åŒ¹é…å¾—åˆ†è¾ƒé«˜
                searchQuery.wildcardTerms.forEach(term => {
                    if (title.includes(term)) score += 30;
                    if (description.includes(term)) score += 15;
                    if (content.includes(term)) score += 5;
                    if (category.includes(term)) score += 8;
                    if (tags.some(tag => tag.includes(term))) score += 10;
                });
 
                // ANDæ“ä½œå¾—åˆ†è¾ƒé«˜
                searchQuery.andTerms.forEach(term => {
                    if (title.includes(term)) score += 20;
                    if (description.includes(term)) score += 10;
                    if (content.includes(term)) score += 5;
                    if (category.includes(term)) score += 8;
                    if (tags.some(tag => tag.includes(term))) score += 12;
                });
 
                // ORæ“ä½œå¾—åˆ†è¾ƒä½
                searchQuery.orTerms.forEach(term => {
                    if (title.includes(term)) score += 10;
                    if (description.includes(term)) score += 5;
                    if (content.includes(term)) score += 2;
                    if (category.includes(term)) score += 3;
                    if (tags.some(tag => tag.includes(term))) score += 5;
                });
 
                // æ‹¬å·ç»„å¾—åˆ†ä¸­ç­‰
                searchQuery.bracketGroups.forEach(group => {
                    const groupTerms = group.split(' ');
                    let groupScore = 0;
 
                    groupTerms.forEach(term => {
                        if (title.includes(term)) groupScore += 15;
                        if (description.includes(term)) groupScore += 8;
                        if (content.includes(term)) groupScore += 3;
                        if (category.includes(term)) groupScore += 5;
                        if (tags.some(tag => tag.includes(term))) groupScore += 8;
                    });
 
                    // å¦‚æœç»„å†…æœ‰å¤šä¸ªåŒ¹é…ï¼Œç»™äºˆé¢å¤–å¥–åŠ±
                    if (groupScore > 15) {
                        score += groupScore * 1.5;
                    } else {
                        score += groupScore;
                    }
                });
 
                // æ’é™¤è¯å¤„ç†ï¼šå¦‚æœåŒ…å«æ’é™¤è¯ï¼Œå¤§å¹…é™ä½å¾—åˆ†
                searchQuery.excludeTerms.forEach(term => {
                    if (title.includes(term)) score -= 30;
                    if (description.includes(term)) score -= 15;
                    if (content.includes(term)) score -= 10;
                });
 
                // å®Œå…¨åŒ¹é…å¾—åˆ†æ›´é«˜
                if (title === searchQuery.originalQuery.toLowerCase()) score += 100;
 
                // ä¸­æ–‡æœç´¢ä¼˜åŒ–ï¼šå¦‚æœæœç´¢è¯æ˜¯ä¸­æ–‡ï¼Œå¢åŠ å¯¹å®Œæ•´åŒ¹é…çš„æƒé‡
                allTerms.forEach(term => {
                    if (this.isChinese(term)) {
                        if (title.includes(term)) score += 15;
                        if (content.includes(term)) score += 8;
                        if (description.includes(term)) score += 10;
                    }
                });
 
                return Math.max(0, score); // ç¡®ä¿å¾—åˆ†ä¸ä¸ºè´Ÿ
            }
 
            // ç”ŸæˆåŒ¹é…ç‰‡æ®µ
            generateSnippet(content, searchQuery) {
                // æ”¶é›†æ‰€æœ‰æœç´¢è¯
                const allTerms = [
                    ...searchQuery.exactMatches,
                    ...searchQuery.andTerms,
                    ...searchQuery.orTerms,
                    ...searchQuery.bracketGroups.flatMap(group => group.split(' ')),
                    ...searchQuery.wildcardTerms
                ].filter(term => term.trim() !== '');
 
                if (allTerms.length === 0) return '';
 
                // æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä½ç½®
                let firstMatchIndex = -1;
                let matchedTerm = '';
 
                for (const term of allTerms) {
                    const index = (content || '').toLowerCase().indexOf(term.toLowerCase());
                    if (index !== -1 && (firstMatchIndex === -1 || index < firstMatchIndex)) {
                        firstMatchIndex = index;
                        matchedTerm = term;
                    }
                }
 
                if (firstMatchIndex === -1) return '';
 
                // æå–ç‰‡æ®µï¼ˆå‰åå„50ä¸ªå­—ç¬¦ï¼‰
                const start = Math.max(0, firstMatchIndex - 50);
                const end = Math.min(content.length, firstMatchIndex + matchedTerm.length + 50);
                let snippet = content.substring(start, end);
 
                // æ·»åŠ çœç•¥å·
                if (start > 0) snippet = '...' + snippet;
                if (end < content.length) snippet = snippet + '...';
 
                // é«˜äº®åŒ¹é…çš„è¯
                snippet = this.highlightText(snippet, matchedTerm);
 
                return snippet;
            }
 
            // åˆ¤æ–­æ˜¯å¦ä¸ºä¸­æ–‡å­—ç¬¦
            isChinese(text) {
                return /[\u4e00-\u9fa5]/.test(text);
            }
 
            // åº”ç”¨é«˜çº§è¿‡æ»¤å™¨
            applyAdvancedFilters() {
                const authorFilter = document.getElementById('filter-author').value.toLowerCase().trim();
                const tagsFilter = document.getElementById('filter-tags').value.toLowerCase().trim();
                const dateFromFilter = document.getElementById('filter-date-from').value;
                const dateToFilter = document.getElementById('filter-date-to').value;
 
                if (!authorFilter && !tagsFilter && !dateFromFilter && !dateToFilter) {
                    // å¦‚æœæ²¡æœ‰è¿‡æ»¤å™¨ï¼Œæ¢å¤åŸå§‹ç»“æœ
                    this.filteredResults = [...this.searchResults];
                } else {
                    this.filteredResults = this.searchResults.filter(item => {
                        // ä½œè€…è¿‡æ»¤å™¨
                        if (authorFilter && !(item.author || '').toLowerCase().includes(authorFilter)) {
                            return false;
                        }
 
                        // æ ‡ç­¾è¿‡æ»¤å™¨
                        if (tagsFilter) {
                            const filterTags = tagsFilter.split(',').map(tag => tag.trim().toLowerCase());
                            const itemTags = (item.tags || []).map(tag => tag.toLowerCase());
                            if (!filterTags.some(filterTag => itemTags.some(itemTag => itemTag.includes(filterTag)))) {
                                return false;
                            }
                        }
 
                        // æ—¥æœŸè¿‡æ»¤å™¨
                        if (dateFromFilter && item.date < dateFromFilter) {
                            return false;
                        }
                        if (dateToFilter && item.date > dateToFilter) {
                            return false;
                        }
 
                        return true;
                    });
                }
 
                this.currentPage = 1;
                this.displaySearchResults();
            }
 
            // æ˜¾ç¤ºæœç´¢ç»“æœ
            displaySearchResults() {
                const resultsContainer = document.getElementById('search-results-container');
                const statsContainer = document.getElementById('search-results-stats');
                const noResultsContainer = document.getElementById('no-search-results');
                const paginationContainer = document.getElementById('pagination-container');
                const resultsCount = document.getElementById('results-count');
 
                // éšè—æ‰€æœ‰ç»“æœå®¹å™¨
                resultsContainer.style.display = 'none';
                statsContainer.style.display = 'none';
                noResultsContainer.style.display = 'none';
                paginationContainer.style.display = 'none';
 
                if (this.filteredResults.length === 0) {
                    // æ˜¾ç¤ºæ— ç»“æœæç¤º
                    noResultsContainer.style.display = 'block';
                } else {
                    // æ˜¾ç¤ºç»“æœç»Ÿè®¡
                    resultsCount.textContent = this.filteredResults.length;
                    statsContainer.style.display = 'flex';
 
                    // è®¡ç®—åˆ†é¡µ
                    const totalPages = Math.ceil(this.filteredResults.length / this.resultsPerPage);
                    const startIndex = (this.currentPage - 1) * this.resultsPerPage;
                    const endIndex = Math.min(startIndex + this.resultsPerPage, this.filteredResults.length);
                    const paginatedResults = this.filteredResults.slice(startIndex, endIndex);
 
                    // æ˜¾ç¤ºæœç´¢ç»“æœ
                    resultsContainer.innerHTML = paginatedResults.map(result =>
                        this.createResultItem(result)
                    ).join('');
                    resultsContainer.style.display = 'block';
 
                    // æ˜¾ç¤ºåˆ†é¡µæ§ä»¶
                    this.displayPagination(totalPages);
 
                    // ç»‘å®šç»“æœé¡¹ç‚¹å‡»äº‹ä»¶
                    resultsContainer.querySelectorAll('.search-result-item-page').forEach((item, index) => {
                        item.addEventListener('click', () => {
                            window.location.href = paginatedResults[index].url;
                        });
                    });
                }
            }
 
            // æ˜¾ç¤ºåˆ†é¡µæ§ä»¶
            displayPagination(totalPages) {
                const paginationContainer = document.getElementById('pagination-container');
                
                if (totalPages <= 1) {
                    paginationContainer.style.display = 'none';
                    return;
                }
 
                paginationContainer.innerHTML = '';
                
                // ä¸Šä¸€é¡µæŒ‰é’®
                const prevButton = document.createElement('button');
                prevButton.className = 'pagination-button';
                prevButton.textContent = 'ä¸Šä¸€é¡µ';
                prevButton.disabled = this.currentPage === 1;
                prevButton.addEventListener('click', () => {
                    if (this.currentPage > 1) {
                    // æ˜¾ç¤ºç»“æœç»Ÿè®¡
                    resultsCount.textContent = this.searchResults.length;
                    statsContainer.style.display = 'flex';

                    // æ˜¾ç¤ºæœç´¢ç»“æœ
                    resultsContainer.innerHTML = this.searchResults.map(result =>
                        this.createResultItem(result)
                    ).join('');
                    resultsContainer.style.display = 'block';

                    // ç»‘å®šç»“æœé¡¹ç‚¹å‡»äº‹ä»¶
                    resultsContainer.querySelectorAll('.search-result-item-page').forEach((item, index) => {
                        item.addEventListener('click', () => {
                            window.location.href = this.searchResults[index].url;
                        });
                    });
                }
            }

            // åˆ›å»ºæœç´¢ç»“æœé¡¹
            createResultItem(result) {
                const highlightedTitle = this.highlightText(result.title || '', this.currentQuery);
                const highlightedDescription = this.highlightText(result.description || '', this.currentQuery);

                // åˆ›å»ºæ ‡ç­¾HTML
                let tagsHtml = '';
                if (result.tags && result.tags.length > 0) {
                    tagsHtml = result.tags.map(tag => 
                        `<span class="search-result-badge" style="background-color: #e9ecef; color: #495057;">${tag}</span>`
                    ).join(' ');
                }

                return `
                    <div class="search-result-item-page">
                        <h3 class="search-result-title-page">${highlightedTitle}</h3>
                        <p class="search-result-description-page">${highlightedDescription}</p>
                        ${result.snippet ? `<p class="search-result-snippet">${result.snippet}</p>` : ''}
                        <div class="search-result-meta-page">
                            <span class="search-result-badge search-result-score">ç›¸å…³æ€§: ${Math.round(result.score || 0)}</span>
                            <span class="search-result-badge">${this.getCategoryText(result.category || '')}</span>
                            <span class="search-result-badge ${result.difficulty}">${this.getDifficultyText(result.difficulty || '')}</span>
                            <span class="search-result-badge">ä½œè€…: ${result.author || 'æœªçŸ¥'}</span>
                            ${tagsHtml ? `<div style="margin-top: 5px;">${tagsHtml}</div>` : ''}
                        </div>
                    </div>
                `;
            }

            // é«˜äº®æ–‡æœ¬
            highlightText(text, query) {
                if (!query || !text) return text || '';

                // åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¿½ç•¥å¤§å°å†™
                const regex = new RegExp(`(${this.escapeRegex(query)})`, 'gi');
                return text.replace(regex, '<mark>$1</mark>');
            }

            // è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦
            escapeRegex(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }

            // æ’åºæœç´¢ç»“æœ
            sortSearchResults(sortBy) {
                switch (sortBy) {
                    case 'title':
                        this.searchResults.sort((a, b) => a.title.localeCompare(b.title));
                        break;
                    case 'date':
                        this.searchResults.sort((a, b) => new Date(b.date) - new Date(a.date));
                        break;
                    case 'difficulty':
                        const difficultyOrder = { 'beginner': 1, 'intermediate': 2, 'advanced': 3 };
                        this.searchResults.sort((a, b) =>
                            (difficultyOrder[a.difficulty] || 999) - (difficultyOrder[b.difficulty] || 999)
                        );
                        break;
                    case 'relevance':
                    default:
                        this.searchResults.sort((a, b) => b.score - a.score);
                        break;
                }

                this.displaySearchResults();
            }

            // ç­›é€‰æœç´¢ç»“æœ
            filterSearchResults() {
                const category = document.getElementById('search-category').value;
                const difficulty = document.getElementById('search-difficulty').value;
                const author = document.getElementById('search-author').value;

                let filteredResults = [...this.searchResults];

                if (category) {
                    filteredResults = filteredResults.filter(result =>
                        result.category.includes(category)
                    );
                }

                if (difficulty) {
                    filteredResults = filteredResults.filter(result =>
                        result.difficulty === difficulty
                    );
                }

                if (author) {
                    filteredResults = filteredResults.filter(result =>
                        result.author === author
                    );
                }

                // ä¸´æ—¶æ˜¾ç¤ºç­›é€‰ç»“æœ
                const resultsContainer = document.getElementById('search-results-container');
                const resultsCount = document.getElementById('results-count');

                if (filteredResults.length === 0) {
                    resultsContainer.innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <p>æ²¡æœ‰ç¬¦åˆç­›é€‰æ¡ä»¶çš„æœç´¢ç»“æœ</p>
                        </div>
                    `;
                } else {
                    resultsCount.textContent = filteredResults.length;
                    resultsContainer.innerHTML = filteredResults.map(result =>
                        this.createResultItem(result)
                    ).join('');

                    // é‡æ–°ç»‘å®šç‚¹å‡»äº‹ä»¶
                    resultsContainer.querySelectorAll('.search-result-item-page').forEach((item, index) => {
                        item.addEventListener('click', () => {
                            window.location.href = filteredResults[index].url;
                        });
                    });
                }
            }

            // åŠ è½½æœç´¢å†å²
            loadSearchHistory() {
                const history = localStorage.getItem('enhancedSearchHistory');
                return history ? JSON.parse(history) : [];
            }

            // ä¿å­˜æœç´¢å†å²
            saveSearchHistory() {
                localStorage.setItem('enhancedSearchHistory', JSON.stringify(this.searchHistory));
            }

            // æ·»åŠ åˆ°æœç´¢å†å²
            addToSearchHistory(query) {
                // ç§»é™¤é‡å¤é¡¹
                this.searchHistory = this.searchHistory.filter(item => item !== query);

                // æ·»åŠ åˆ°å¼€å¤´
                this.searchHistory.unshift(query);

                // é™åˆ¶å†å²è®°å½•æ•°é‡
                if (this.searchHistory.length > 10) {
                    this.searchHistory = this.searchHistory.slice(0, 10);
                }

                // ä¿å­˜
                this.saveSearchHistory();

                // æ›´æ–°æ˜¾ç¤º
                this.displaySearchHistory();
            }

            // æ¸…é™¤æœç´¢å†å²
            clearSearchHistory() {
                this.searchHistory = [];
                this.saveSearchHistory();
                this.displaySearchHistory();
            }

            // æ˜¾ç¤ºæœç´¢å†å²
            displaySearchHistory() {
                const historyContainer = document.getElementById('search-history-list');
                const historySection = document.getElementById('search-history-container');

                if (this.searchHistory.length === 0) {
                    historySection.style.display = 'none';
                    return;
                }

                historySection.style.display = 'block';
                historyContainer.innerHTML = this.searchHistory.map(query => `
                    <div class="search-history-item" data-query="${query}">
                        <span>${query}</span>
                        <span class="remove">Ã—</span>
                    </div>
                `).join('');

                // ç»‘å®šç‚¹å‡»äº‹ä»¶
                historyContainer.querySelectorAll('.search-history-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        if (e.target.classList.contains('remove')) {
                            // ç§»é™¤å†å²é¡¹
                            const query = item.dataset.query;
                            this.searchHistory = this.searchHistory.filter(h => h !== query);
                            this.saveSearchHistory();
                            this.displaySearchHistory();
                        } else {
                            // æ‰§è¡Œæœç´¢
                            const query = item.dataset.query;
                            document.getElementById('advanced-search-input').value = query;
                            this.currentQuery = query;
                            this.performSearch();
                        }
                    });
                });
            }

            // è·å–ç±»åˆ«æ–‡æœ¬
            getCategoryText(category) {
                const categories = {
                    'å…¥é—¨æŒ‡å—': 'å…¥é—¨æŒ‡å—',
                    'åŸºç¡€': 'åŸºç¡€',
                    'ä¸­é˜¶': 'ä¸­é˜¶',
                    'é«˜é˜¶': 'é«˜é˜¶',
                    'ä¸“å®¶': 'ä¸“å®¶',
                    'æ¦‚å¿µäº†è§£': 'æ¦‚å¿µäº†è§£',
                    'åŸç‰ˆä»£ç æ–‡æ¡£': 'åŸç‰ˆä»£ç æ–‡æ¡£',
                    'æ‚é¡¹': 'æ‚é¡¹',
                    'æ€ä¹ˆè´¡çŒ®': 'æ€ä¹ˆè´¡çŒ®'
                };
                return categories[category] || category;
            }

            // è·å–éš¾åº¦æ–‡æœ¬
            getDifficultyText(difficulty) {
                const difficulties = {
                    'beginner': 'åˆçº§',
                    'intermediate': 'ä¸­çº§',
                    'advanced': 'é«˜çº§',
                    'åˆçº§': 'åˆçº§',
                    'ä¸­çº§': 'ä¸­çº§',
                    'é«˜çº§': 'é«˜çº§',
                    'å…¨éƒ¨çº§åˆ«': 'å…¨éƒ¨çº§åˆ«'
                };
                return difficulties[difficulty] || difficulty;
            }
        }

        // é˜²æŠ–å‡½æ•°
        function debounce(func, wait) {
            let timeout;
            return function () {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    func.apply(context, args);
                }, wait);
            };
        }

        // åˆå§‹åŒ–æœç´¢ç»“æœé¡µé¢
        document.addEventListener('DOMContentLoaded', function () {
            window.enhancedSearchResultsPage = new EnhancedSearchResultsPage();
        });
    </script>
</body>

</html>